<aj-wrapper
  title="Temps moyens"
  class="content-margin-null"
  [subtitle]="subTitleDate"
  [subtitleName]="subTitleName"
  [actionTemplate]="actions"
  [isLoading]="isLoading"
>
  <div class="container">
    <div class="header-list">
      <div class="label empty"></div>
      <div class="label col">Temps moyens en heures</div>
      <div class="label col">Nombre de dossiers par jour</div>
      <div class="label col">Nombre de dossiers par mois</div>

      <!-- 
      <div class="column-item">
        <mat-button-toggle-group [value]="perUnity">
          <mat-button-toggle value="hour" (click)="changeUnity('hour')"
            >Temps moyen en heure
          </mat-button-toggle>
          <mat-button-toggle value="day" (click)="changeUnity('day')"
            >Nombre de dossiers par jour
          </mat-button-toggle>
        </mat-button-toggle-group>
      </div>
      -->
    </div>
    <div class="content-list">
      <div *ngFor="let ref of referentiel" class="item-grouped">
        <div
          class="item"
          (click)="ref.showOptionGroup = !ref.showOptionGroup"
          [class.selectable]="(ref.childrens || []).length"
        >
          <div class="label head">
            <div
              class="color-border"
              [style.backgroundColor]="ref.showOptionGroup ? null : referentielMappingColor(ref.label)"
            ></div>
            <mat-icon *ngIf="(ref.childrens || []).length"
              >{{ ref.showOptionGroup ? 'expand_less' : 'expand_more' }}
            </mat-icon>
            <p>{{ref.label}}</p>
          </div>
          <div class="column-item">
            <div class="label col">
              <app-time-selector
                *ngIf="perUnity === 'hour'"
                [value]="ref.averageProcessingTime ? (perUnity === 'hour' ? ref.averageProcessingTime : fixDecimal(8 / ref.averageProcessingTime)) : 0"
                (valueChange)="onUpdateOptions(ref, $event)"
                [disabled]="true"
              ></app-time-selector>
            </div>
            <div class="label col">Nombre de dossiers par jour</div>
            <div class="label col no-margin">Nombre de dossiers par mois</div>

            <!-- 
            <app-time-selector
              *ngIf="perUnity === 'hour'"
              [value]="ref.averageProcessingTime ? (perUnity === 'hour' ? ref.averageProcessingTime : fixDecimal(8 / ref.averageProcessingTime)) : 0"
              (valueChange)="onUpdateOptions(ref, $event)"
              [disabled]="true"
            ></app-time-selector>
            <input
              *ngIf="perUnity !== 'hour'"
              type="number"
              [ngModel]="ref.averageProcessingTime ? (perUnity === 'hour' ? ref.averageProcessingTime : fixDecimal(8 / ref.averageProcessingTime)) : ''"
              (ngModelChange)="onUpdateOptions(ref, $event)"
              min="0"
            />

            <p>
              {{perUnity === 'hour' ? '&nbsp; temps moyen en heure:minute' :
              'nombre de dossiers par jour'}}
            </p>
            -->
          </div>
        </div>
        <div class="group" [class.enable]="ref.showOptionGroup">
          <div
            class="group-item"
            *ngFor="let itemGroup of (ref.childrens ||Â [])"
            [style.borderColor]="referentielMappingColor(ref.label)"
          >
            <div class="label">
              <p>{{itemGroup.label}}</p>
            </div>
            <div class="column-item">
              <!-- 
              <app-time-selector
                *ngIf="perUnity === 'hour'"
                [value]="itemGroup.averageProcessingTime ? (perUnity === 'hour' ? itemGroup.averageProcessingTime : fixDecimal(8 / itemGroup.averageProcessingTime)) : 0"
                (valueChange)="onUpdateOptions(itemGroup, $event)"
              ></app-time-selector>
              <input
                *ngIf="perUnity !== 'hour'"
                type="number"
                [ngModel]="itemGroup.averageProcessingTime ? (perUnity === 'hour' ? itemGroup.averageProcessingTime : fixDecimal(8 / itemGroup.averageProcessingTime)) : ''"
                (ngModelChange)="onUpdateOptions(itemGroup, $event)"
                min="0"
              />

              <p>
                {{perUnity === 'hour' ? '&nbsp; temps moyen en heure:minute' :
                'nombre de dossiers par jour'}}
              </p>
            --></div>
          </div>
        </div>
      </div>
      <div class="separator"></div>
    </div>
  </div>

  <div class="sticky-action-footer">
    <aj-options-backup-panel></aj-options-backup-panel>
  </div>
</aj-wrapper>

<ng-template #actions>
  <div class="flex-1"></div>

  <div class="categories-switch">
    <div
      class="magistrats"
      [ngClass]="{'selected': categorySelected === MAGISTRATS}"
      (click)="$event.stopPropagation(); changeCategorySelected(MAGISTRATS)"
    >
      <input type="radio" [checked]="categorySelected === MAGISTRATS" />
      <p>Magistrats</p>
    </div>
    <div
      class="fonctionnaires"
      [ngClass]="{'selected': categorySelected === FONCTIONNAIRES}"
      class="fonctionnaires"
      (click)="$event.stopPropagation(); changeCategorySelected(FONCTIONNAIRES)"
    >
      <input type="radio" [checked]="categorySelected === FONCTIONNAIRES" />
      <p>Fonctionnaires</p>
    </div>
  </div>
  <aj-select
    title="Mes temps moyens de comparaison"
    [value]="selectedIds"
    [datas]="formDatas"
    (valueChange)="onChangeBackup($event)"
    [multiple]="false"
    class="bg-white"
  >
  </aj-select>
</ng-template>
