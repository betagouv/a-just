@if (calculator) {
<div class="main-referentiel" [style.backgroundColor]="
      userService.referentielMappingColorActivityByInterface(
        userService.referentielMappingNameByInterface(
          calculator.contentieux.label === 'Autres activités' ? 'other' : calculator.contentieux.label
        ),
        OPACITY
      )
    ">
  <div (click)="onToggleChildren()">
    @if (calculator.childrens && calculator.childrens.length) {
    <mat-icon class="no-print">{{ showChildren ? 'expand_more' : 'chevron_right' }}</mat-icon>
    }
    <p>
      {{
      userService.isCa()
      ? calculator.contentieux.label
      : userService.referentielMappingNameByInterface(calculator.contentieux.label)
      }}
    </p>
    @if(cockpitWarningInformations) {
    @if(cockpitWarningInformations.ventilation.dataNotUpdatedBefore6Month
    || cockpitWarningInformations.ventilation.haveIncompleteDatasDuringThisPeriod
    || cockpitWarningInformations.activity.dataNotUpdatedBefore12Month
    || cockpitWarningInformations.activity.lessOneOfDatasToSubContentieux
    || cockpitWarningInformations.activity.missingDatasToSubContentieuxBefore12Month) {
    <div class="help warning"
      (click)="$event.stopPropagation(); this.currentProjection = calculator; showAlertPopin = true;">
      <span>!</span>
    </div>
    } @else {
    <div class="help" (click)="$event.stopPropagation(); this.currentProjection = calculator; showAlertPopin = true;">
      <span>?</span>
    </div>
    }
    }
  </div>
  <div [ngClass]="{'dtes': calculator.realDTESInMonths !== null && checkPastDate()}">
    @if (!isSoutien(calculator.contentieux.id)) {
    <div class="block">
      @if (calculator.realDTESInMonths !== null && checkPastDate()) {
      @if (calculator.realCoverageBf !==null && calculator.realCoverageAf !== null && calculator.realCoverageBf
      > calculator.realCoverageAf) { <img src="/assets/icons/cockpit-down.svg" alt="cockpit-down"
        class="cockpit-down" />}
      @else { <img src="/assets/icons/cockpit-up.svg" alt="cockpit-up" class="cockpit-up" /> }
      <p>{{ calculator.realDTESInMonths | number: '0.2-2' }} mois</p>
      }
      @else {
      <div class="ref-nr">
        <aj-tooltips title="Donnée non renseignée" class="small"
          content="Chiffre non calculable à partir des données d’activité enregistrées à ce jour : si vous en disposez, veuillez les compléter dans l'écran “données d’activité”."></aj-tooltips>
        <p>N/R</p>
      </div>
      }
    </div>
    }
  </div>
  <div>
    @if (!isSoutien(calculator.contentieux.id)) {
    <div class="block">
      @if (checkPastDate() && calculator.totalOut !== null && calculator.totalIn !== null) {
      <aj-speedometer [percent]="round((calculator.realCoverage || 0) * 100)"></aj-speedometer>
      } @else {
      <div class="ref-nr">
        <aj-tooltips title="Donnée non renseignée" class="small"
          content="Chiffre non calculable à partir des données d’activité enregistrées à ce jour : si vous en disposez, veuillez les compléter dans l'écran “données d’activité”."></aj-tooltips>
        <p>N/R</p>
      </div>
      }
    </div>
    }
  </div>
  <div [ngClass]="{'stock': calculator.lastStock !== null && checkPastDate()}">
    @if (!isSoutien(calculator.contentieux.id)) {
    @if (calculator.lastStock !== null && checkPastDate()) {
    <div class="block">
      @if (calculator.totalOutBf !==null && calculator.totalOutAf !== null && calculator.totalOutBf
      > calculator.totalOutAf) { <img src="/assets/icons/cockpit-down.svg" alt="cockpit-down" class="cockpit-down" />}
      @else { <img src="/assets/icons/cockpit-up.svg" alt="cockpit-up" class="cockpit-up" /> }
      <p>{{ calculator.lastStock }}</p>
    </div>
    } @else {
    <div class="ref-nr">
      <aj-tooltips title="Donnée non renseignée" class="small"
        content="Chiffre non calculable à partir des données d’activité enregistrées à ce jour : si vous en disposez, veuillez les compléter dans l'écran “données d’activité”."></aj-tooltips>
      <p>N/R</p>
    </div>
    }
    }
  </div>
  <div>
    @if(categoryIdSelected) {
    <p class="etpt-selected">
      @if(canViewMagistrat) {<span>{{ calculator.etpMag | number: '0.2-2' }}</span>}
      @if(canViewGreffier) {<span>{{ calculator.etpFon | number: '0.2-2' }}</span>}
      @if(canViewContractuel) {<span>{{ calculator.etpCont | number: '0.2-2' }}</span>}
    </p>}
    @else {
    @if(canViewMagistrat) {<p>{{ calculator.etpMag | number: '0.2-2' }}</p>}
    @else if(canViewGreffier) {<p>{{ calculator.etpFon | number: '0.2-2' }}</p>}
    @else if(canViewContractuel) {<p>{{ calculator.etpCont | number: '0.2-2' }}</p>}
    }
  </div>
  <div>
    <div class="anticipate"
      (click)="this.currentProjection = calculator; initProjectionFooterGrid(); showProjectionPopin = true;" [ngStyle]="{ borderColor: userService.referentielMappingColorActivityByInterface(
            userService.referentielMappingNameByInterface(
              calculator.contentieux.label === 'Autres activités' ? 'other' : calculator.contentieux.label
            )
          ) }">
      <p [ngStyle]="{ color: userService.referentielMappingColorActivityByInterface(
            userService.referentielMappingNameByInterface(
              calculator.contentieux.label === 'Autres activités' ? 'other' : calculator.contentieux.label
            )
          ) }">Se projeter</p>
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" fill="none">
        <path d="M1.5 9.75H6V15.75H1.5V9.75ZM6.75 2.25H11.25V15.75H6.75V2.25ZM12 6H16.5V15.75H12V6Z" [attr.fill]="userService.referentielMappingColorActivityByInterface(
            userService.referentielMappingNameByInterface(
              calculator.contentieux.label === 'Autres activités' ? 'other' : calculator.contentieux.label
            )
          )" />
      </svg>
    </div>
  </div>
</div>
}
@if ((showChildren || forceToShowChildren) && calculator && calculator.childrens && calculator.childrens.length) {
<div class="childrens">
  @for (r of calculator.childrens; track r.contentieux.id) {
  <aj-referentiel-calculator [datas]="calculator.childrens" [calculator]="r" [sortBy]="sortBy" class="is-child"
    [categorySelected]="categorySelected" [categoryFiltered]="categoryFiltered"
    [categoryIdSelected]="categoryIdSelected" [parentCalculator]="calculator"
    [currentProjectionType]="currentProjectionType"
    (currentProjectionTypeChange)="onCurrentProjectionTypeChange($event)"></aj-referentiel-calculator>
  }
</div>
}

@if(currentProjection && showAlertPopin && appService.appLoading.getValue() === false && cockpitWarningInformations) {
<div class="popin-projection">
  <div class="popin-projection-content" (click)="$event.stopPropagation()">
    <div class="popin-projection-content-header" [ngStyle]="{ backgroundColor: userService.referentielMappingColorActivityByInterface(
              userService.referentielMappingNameByInterface(
              (parentCalculator || currentProjection).contentieux.label === 'Autres activités' ? 'other' : (parentCalculator || currentProjection).contentieux.label
              )
            , OPACITY_20) }">
      <div class="header-title-alert">
        <a [href]="findHelpCenter('/contact')+(referentielService.isDroitLocal() ? '?dl=true&contact=true': '?contact=true')"
          target="_blank">Une question sur vos données ?</a>
      </div>
      <div class="header-title">
        <div>
          @if(canViewPreviousProjection) {
          <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25" fill="none"
            (click)="onPreviousProjection();">
            <path fill-rule="evenodd" clip-rule="evenodd"
              d="M10.8857 12.0574L15.8594 7.08373L14.4386 5.66296L8.04413 12.0574L14.4386 18.4519L15.8594 17.0311L10.8857 12.0574Z"
              fill="#3A3A3A" />
          </svg>
          }
        </div>
        <p>{{ userService.referentielMappingNameByInterface(currentProjection.contentieux.label) }}</p>
        <div>
          @if(canViewNextProjection) {
          <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25" fill="none"
            (click)="onNextProjection()">
            <path fill-rule="evenodd" clip-rule="evenodd"
              d="M13.2315 12.0574L8.25781 7.08373L9.67858 5.66296L16.0731 12.0574L9.67858 18.4519L8.25781 17.0311L13.2315 12.0574Z"
              fill="#3A3A3A" />
          </svg>
          }
        </div>
      </div>
      <div (click)="currentProjection = null; showAlertPopin = false;" class="close-bt">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22" fill="none">
          <g clip-path="url(#clip0_1068_20173)">
            <path fill-rule="evenodd" clip-rule="evenodd"
              d="M11 20.625C5.68425 20.625 1.375 16.3144 1.375 11C1.375 5.68563 5.68425 1.375 11 1.375C16.3158 1.375 20.625 5.68563 20.625 11C20.625 16.3144 16.3158 20.625 11 20.625ZM11 0C4.92456 0 0 4.9225 0 11C0 17.0775 4.92456 22 11 22C17.0754 22 22 17.0775 22 11C22 4.9225 17.0754 0 11 0ZM14.9304 7.06752C14.6595 6.7994 14.2216 6.7994 13.9507 7.06752L10.9959 10.0237L8.08362 7.10873C7.81481 6.8406 7.37893 6.8406 7.1115 7.10873C6.84268 7.37685 6.84268 7.81688 7.1115 8.08501L10.0238 10.9931L7.09089 13.9288C6.82071 14.1969 6.82071 14.6368 7.09089 14.9118C7.36177 15.18 7.80037 15.18 8.07124 14.9118L11.0041 11.9763L13.9164 14.8913C14.1852 15.1594 14.6211 15.1594 14.8892 14.8913C15.158 14.6231 15.158 14.1831 14.8892 13.915L11.9762 11.0069L14.9304 8.0506C15.2006 7.7756 15.2006 7.34252 14.9304 7.06752Z"
              fill="#3A3A3A" />
          </g>
          <defs>
            <clipPath id="clip0_1068_20173">
              <rect width="22" height="22" fill="white" />
            </clipPath>
          </defs>
        </svg>
      </div>
    </div>
    <div class="popin-alert-content-body">
      <div>
        <div class="popin-alert-content-body-top">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path fill-rule="evenodd" clip-rule="evenodd"
              d="M7 12C9.76142 12 12 14.2386 12 17V21H10V17C10 15.3431 8.65685 14 7 14C5.34315 14 4 15.3431 4 17V21H2V17C2 14.2386 4.23858 12 7 12ZM19.75 16.6029C21.1423 17.4067 22 18.8923 22 20.5V21H20V20.5C20 19.1193 18.8807 18 17.5 18C16.1193 18 15 19.1193 15 20.5V21H13V20.5C13 18.8923 13.8577 17.4067 15.25 16.6029C16.6423 15.799 18.3577 15.799 19.75 16.6029ZM17.5 7C19.7091 7 21.5 8.79086 21.5 11C21.5 13.2091 19.7091 15 17.5 15C15.2909 15 13.5 13.2091 13.5 11C13.5 8.79086 15.2909 7 17.5 7ZM17.5 9C16.3954 9 15.5 9.89543 15.5 11C15.5 12.1046 16.3954 13 17.5 13C18.6046 13 19.5 12.1046 19.5 11C19.5 9.89543 18.6046 9 17.5 9ZM7 2C9.48528 2 11.5 4.01472 11.5 6.5C11.5 8.98528 9.48528 11 7 11C5.3923 11 3.90673 10.1423 3.10289 8.75C2.29904 7.3577 2.29904 5.6423 3.10289 4.25C3.90673 2.8577 5.3923 2 7 2ZM7 4C5.61929 4 4.5 5.11929 4.5 6.5C4.5 7.88071 5.61929 9 7 9C8.38071 9 9.5 7.88071 9.5 6.5C9.5 5.11929 8.38071 4 7 4Z"
              fill="#000091" />
          </svg>
          <p>Données d’effectif</p>
          <a class="documentation-link" [href]="VENTILATEUR_DOCUMENTATION_URL" target="_blank">?</a>
          <span class="flex-1"></span>
          <a [routerLink]="['/ventilations']"><button class="strict-border outline primary">Mettre à
              jour</button></a>
        </div>
        <div class="popin-alert-content-body-info"
          [ngClass]="{'warning': cockpitWarningInformations.ventilation.dataNotUpdatedBefore6Month}">
          <p>Dernière mise à jour : @if(currentProjection.lastVentilationUpdatedAt) {<span>{{
              currentProjection.lastVentilationUpdatedAt | date: 'dd/MM/yyyy' }}</span>} @else {<span>Inconnue</span>}
          </p>
        </div>
        <div class="popin-alert-content-body-messages">
          @if(!parentCalculator) {
          @if(cockpitWarningInformations.ventilation.dataNotUpdatedBefore6Month) {
          <div class="blue">
            <span>Fraîcheur</span>
            <p>Les ventilations sur ce contentieux n'ont pas été mises à jour depuis plus de 6 mois.</p>
          </div>
          }
          @if(cockpitWarningInformations.ventilation.nbAgentNotCompletedToday > 0) {
          <div class="blue">
            <span>Fraîcheur</span>
            <p>Il y a {{ cockpitWarningInformations.ventilation.nbAgentNotCompletedToday }} agent{{
              cockpitWarningInformations.ventilation.nbAgentNotCompletedToday > 1 ? 's' : '' }} de la juridiction dont
              l'activité n'a pas été ou pas totalement renseignée aujourd'hui.
            </p>
          </div>
          }
          @if(cockpitWarningInformations.ventilation.haveIncompleteDatasDuringThisPeriod) {
          <div class="orange">
            <span>Hétérogénéité des données</span>
            <p>Des ventilations d'agents affectés à ce contentieux semblent incomplètes sur cette période.</p>
          </div>
          }
          } @else {
          <div class="blue">
            <span>Fraîcheur</span>
            <p>Les ventilations sur ce sous-contentieux n'ont pas été mises à jour depuis plus de 6 mois.</p>
          </div>
          <div class="blue">
            <span>Fraîcheur</span>
            <p>Il y a X agents de la juridiction dont l'activité n'a pas été ou pas totalement ventilée.</p>
          </div>
          <div class="orange">
            <span>Hétérogénéité des données</span>
            <p>Tous les agents de la juridiction affectés au contentieux (niveau 3) n'ont pas été ventilés au niveau 4.
            </p>
          </div>
          <div class="orange">
            <span>Hétérogénéité des données</span>
            <p>Des ventilations d'agents affectés à ce contentieux semblent incomplètes sur cette période.
            </p>
          </div>
          }
        </div>
      </div>
      <div>
        <div class="popin-alert-content-body-top">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path
              d="M20 14.25C21.2426 14.25 22.25 13.2426 22.25 12C22.25 10.7574 21.2426 9.75 20 9.75C18.7574 9.75 17.75 10.7574 17.75 12C17.75 13.2426 18.7574 14.25 20 14.25Z"
              fill="#000091" />
            <path
              d="M20 6.25024C21.2426 6.25024 22.25 5.24288 22.25 4.00024C22.25 2.7576 21.2426 1.75024 20 1.75024C18.7574 1.75024 17.75 2.7576 17.75 4.00024C17.75 5.24288 18.7574 6.25024 20 6.25024Z"
              fill="#000091" />
            <path
              d="M20 22.2498C21.2426 22.2498 22.25 21.2424 22.25 19.9998C22.25 18.7572 21.2426 17.7498 20 17.7498C18.7574 17.7498 17.75 18.7572 17.75 19.9998C17.75 21.2424 18.7574 22.2498 20 22.2498Z"
              fill="#000091" />
            <path
              d="M4 14.25C5.24264 14.25 6.25 13.2426 6.25 12C6.25 10.7574 5.24264 9.75 4 9.75C2.75736 9.75 1.75 10.7574 1.75 12C1.75 13.2426 2.75736 14.25 4 14.25Z"
              fill="#000091" />
            <path
              d="M19 12.7502C19.41 12.7502 19.75 12.4102 19.75 12.0002C19.75 11.5902 19.41 11.2502 19 11.2502H11.75V7.00024C11.75 5.42024 12.42 4.75024 14 4.75024H19C19.41 4.75024 19.75 4.41024 19.75 4.00024C19.75 3.59024 19.41 3.25024 19 3.25024H14C11.58 3.25024 10.25 4.58024 10.25 7.00024V11.2502H5C4.59 11.2502 4.25 11.5902 4.25 12.0002C4.25 12.4102 4.59 12.7502 5 12.7502H10.25V17.0002C10.25 19.4202 11.58 20.7502 14 20.7502H19C19.41 20.7502 19.75 20.4102 19.75 20.0002C19.75 19.5902 19.41 19.2502 19 19.2502H14C12.42 19.2502 11.75 18.5802 11.75 17.0002V12.7502H19Z"
              fill="#000091" />
          </svg>
          <p>Données Activité</p>
          <a class="documentation-link" [href]="ACTIVITIES_DOCUMENTATION_URL" target="_blank">?</a>
          <span class="flex-1"></span>
          <a [routerLink]="['/donnees-d-activite']"><button class="strict-border primary">Mettre à
              jour</button></a>
        </div>
        <div class="popin-alert-content-body-info"
          [ngClass]="{'warning': cockpitWarningInformations.activity.dataNotUpdatedBefore12Month}">
          <p>Dernière mise à jour : @if(currentProjection.lastActivityUpdatedAt) {<span>{{
              currentProjection.lastActivityUpdatedAt | date: 'dd/MM/yyyy' }}</span>} @else {<span>Inconnue</span>}</p>
        </div>
        <div class="popin-alert-content-body-messages">
          @if(!parentCalculator) {
          @if(cockpitWarningInformations.activity.dataNotUpdatedBefore12Month) {
          <div class="blue">
            <span>Fraîcheur</span>
            <p>Il n'y a aucune donnée renseignée sur ce contentieux pour les 12 derniers mois.</p>
          </div>
          }
          @if(cockpitWarningInformations.activity.noDataToSubContentieuxDuring12Month) {
          <div class="blue">
            <span>Fraîcheur</span>
            <p>Il n'y a aucune donnée renseignée sur ces sous-contentieux de ce contentieux pour les 12 derniers mois.
            </p>
          </div>
          }
          @if(cockpitWarningInformations.activity.lessOneOfDatasToSubContentieux) {
          <div class="orange">
            <span>Hétérogénéité des données</span>
            <p>Il n'y a aucune donnée, de sortie, de stock dans au moins un des sous-contentieux de ce contentieux.
            </p>
          </div>
          }
          @if(cockpitWarningInformations.activity.missingDatasToSubContentieuxBefore12Month) {
          <div class="orange">
            <span>Hétérogénéité des données</span>
            <p>Des données d'activité manquantes dans l'un des sous-contentieux ont été complétées sur certains des 12
              derniers mois mis à jour mais pas sur tous.</p>
          </div>
          }
          } @else {
          <div class="blue">
            <span>Fraîcheur</span>
            <p>Il n'y a aucune donnée renseignée sur ce sous-contentieux pour les 12 derniers mois.</p>
          </div>
          <div class="blue">
            <span>Fraîcheur</span>
            <p>Il manque toutes les données de ses sous-contentieux pour les 12 derniers mois.</p>
          </div>
          <div class="orange">
            <span>Hétérogénéité des données</span>
            <p>Il n'y a aucune donnée, d'entrée, de sortie, de stock dans l'un ou plusieurs des sous-contentieux.
            </p>
          </div>
          <div class="orange">
            <span>Hétérogénéité des données</span>
            <p>Des données d'activité manquantes dans l'un de ces sous-contentieux ont été complétées sur certains des
              12 mois pas sur tous.
            </p>
          </div>
          }
        </div>
      </div>
    </div>
  </div>
</div>
}

@if(currentProjection !== null && showProjectionPopin && appService.appLoading.getValue() === false) {
<div class="popin-projection">
  <div class="popin-projection-content" (click)="$event.stopPropagation()">
    <div class="popin-projection-content-header" [ngStyle]="{ backgroundColor: userService.referentielMappingColorActivityByInterface(
            userService.referentielMappingNameByInterface(
            (parentCalculator || currentProjection).contentieux.label === 'Autres activités' ? 'other' : (parentCalculator || currentProjection).contentieux.label
            )
          , OPACITY_20) }">
      <div class="switch-bt">
        @for (type of projectionTypes; track type.value) {
        <div (click)="onCurrentProjectionTypeChange(type.value)"
          [ngClass]="{'active': currentProjectionType === type.value}">
          <mat-icon>{{ type.icon }}</mat-icon>
          <p>{{ type.label }}</p>
        </div>
        }
      </div>
      <div class="header-title">
        <div>
          @if(canViewPreviousProjection) {
          <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25" fill="none"
            (click)="onPreviousProjection()">
            <path fill-rule="evenodd" clip-rule="evenodd"
              d="M10.8857 12.0574L15.8594 7.08373L14.4386 5.66296L8.04413 12.0574L14.4386 18.4519L15.8594 17.0311L10.8857 12.0574Z"
              fill="#3A3A3A" />
          </svg>
          }
        </div>
        <p>{{ userService.referentielMappingNameByInterface(currentProjection.contentieux.label) }}</p>
        <div>
          @if(canViewNextProjection) {
          <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25" fill="none"
            (click)="onNextProjection()">
            <path fill-rule="evenodd" clip-rule="evenodd"
              d="M13.2315 12.0574L8.25781 7.08373L9.67858 5.66296L16.0731 12.0574L9.67858 18.4519L8.25781 17.0311L13.2315 12.0574Z"
              fill="#3A3A3A" />
          </svg>
          }
        </div>
      </div>
      <div (click)="currentProjection = null; showProjectionPopin = false;" class="close-bt">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22" fill="none">
          <g clip-path="url(#clip0_1068_20173)">
            <path fill-rule="evenodd" clip-rule="evenodd"
              d="M11 20.625C5.68425 20.625 1.375 16.3144 1.375 11C1.375 5.68563 5.68425 1.375 11 1.375C16.3158 1.375 20.625 5.68563 20.625 11C20.625 16.3144 16.3158 20.625 11 20.625ZM11 0C4.92456 0 0 4.9225 0 11C0 17.0775 4.92456 22 11 22C17.0754 22 22 17.0775 22 11C22 4.9225 17.0754 0 11 0ZM14.9304 7.06752C14.6595 6.7994 14.2216 6.7994 13.9507 7.06752L10.9959 10.0237L8.08362 7.10873C7.81481 6.8406 7.37893 6.8406 7.1115 7.10873C6.84268 7.37685 6.84268 7.81688 7.1115 8.08501L10.0238 10.9931L7.09089 13.9288C6.82071 14.1969 6.82071 14.6368 7.09089 14.9118C7.36177 15.18 7.80037 15.18 8.07124 14.9118L11.0041 11.9763L13.9164 14.8913C14.1852 15.1594 14.6211 15.1594 14.8892 14.8913C15.158 14.6231 15.158 14.1831 14.8892 13.915L11.9762 11.0069L14.9304 8.0506C15.2006 7.7756 15.2006 7.34252 14.9304 7.06752Z"
              fill="#3A3A3A" />
          </g>
          <defs>
            <clipPath id="clip0_1068_20173">
              <rect width="22" height="22" fill="white" />
            </clipPath>
          </defs>
        </svg>
      </div>
    </div>
    <div class="popin-projection-content-body">
      <canvas #chartjs></canvas>
      @if(nbMonthsToCompare > 0) {<div class="preview-date-range">
        <p [ngStyle]="{ color: userService.referentielMappingColorActivityByInterface(
          userService.referentielMappingNameByInterface(
          (parentCalculator || currentProjection).contentieux.label === 'Autres activités' ? 'other' : (parentCalculator || currentProjection).contentieux.label
          )
        ) }">{{nbMonthsToCompare}} dernier{{nbMonthsToCompare > 1 ? 's' : ''}} mois</p>
        <p [ngStyle]="{ color: userService.referentielMappingColorActivityByInterface(
          userService.referentielMappingNameByInterface(
          (parentCalculator || currentProjection).contentieux.label === 'Autres activités' ? 'other' : (parentCalculator || currentProjection).contentieux.label
          )
        ) }">{{nbMonthsToCompare}} prochain{{nbMonthsToCompare > 1 ? 's' : ''}} mois</p>
      </div>}
    </div>
    @if(projectionFooterGrid.length) {
    <div class="popin-projection-content-footer"
      [ngStyle]="{ gridTemplateColumns: 'repeat('+  projectionFooterGrid.length +', 1fr)' }">
      @for (item of projectionFooterGrid; track item.label) {
      <div [ngStyle]="{ backgroundColor: userService.referentielMappingColorActivityByInterface(
        userService.referentielMappingNameByInterface(
        (parentCalculator || currentProjection).contentieux.label === 'Autres activités' ? 'other' : (parentCalculator || currentProjection).contentieux.label
        )
      , OPACITY_20) }">
        <p [ngStyle]="{ color: userService.referentielMappingColorActivityByInterface(
          userService.referentielMappingNameByInterface(
          (parentCalculator || currentProjection).contentieux.label === 'Autres activités' ? 'other' : (parentCalculator || currentProjection).contentieux.label
          )
        ) }">{{ item.label }}</p>
        <a [routerLink]="item.link" [queryParams]="item.queryParams" [ngStyle]="{ color: userService.referentielMappingColorActivityByInterface(
          userService.referentielMappingNameByInterface(
          (parentCalculator || currentProjection).contentieux.label === 'Autres activités' ? 'other' : (parentCalculator || currentProjection).contentieux.label
          )
        ), borderColor: userService.referentielMappingColorActivityByInterface(
          userService.referentielMappingNameByInterface(
          (parentCalculator || currentProjection).contentieux.label === 'Autres activités' ? 'other' : (parentCalculator || currentProjection).contentieux.label
          )
        ) }">{{ item.button }}</a>
      </div>
      }
    </div>
    }
  </div>
</div>
}