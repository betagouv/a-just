<aj-wrapper title="Calculateur" [actionTemplate]="actions" class="content-margin-null">
  <div class="container">
    <div class="header-calculator">
      <div class="title-header-calculator">
        <div class="width-contentieux"></div>
        <div class="item">
          <p>Données constatées</p>
        </div>
        <div class="item activity">
          <p>Activité constatée</p>
        </div>
        <div class="item calculate">
          <p>Activité calculée</p>
        </div>
      </div>
      <div class="explanation-calculator">
        <div class="width-contentieux"></div>
        <div class="item">
          <p>
            Données renseignées depuis les écrans
            <a routerLink="/ventilations">Affectation des ETP</a> et
            <a routerLink="/donnees-d-activite">Données d’activité</a>
          </p>
        </div>
        <div class="item activity">
          <p>Calculs effectués à partir des données constatées</p>
        </div>
        <div class="item calculate">
          <p>
            Calculs théoriques effectués à partir des temps moyens de
            comparaison sélectionnés dans « Mes temps moyens de comparaison »
          </p>
        </div>
      </div>
      <div class="contentieux-header-calculator">
        <div class="width-contentieux">
          <p>CONTENTIEUX</p>
        </div>
        <div class="item">
          <div class="tooltip" (click)="onSortBy('totalIn')" [ngClass]="{'selected': sortBy === 'totalIn'}">
            <p>ENTRÉES</p>
            <mat-icon>{{ sortBy === 'totalIn' ? 'filter_list' : 'filter_list_off' }}</mat-icon>
            <span class="tooltip-text">Entrées mensuelles moyennes sur la période</span>
          </div>
          <div class="tooltip" (click)="onSortBy('totalOut')" [ngClass]="{'selected': sortBy === 'totalOut'}">
            <p>SORTIES</p>
            <mat-icon>{{ sortBy === 'totalOut' ? 'filter_list' : 'filter_list_off' }}</mat-icon>
            <span class="tooltip-text">Sorties mensuelles moyennes sur la période</span>
          </div>
          <div class="tooltip" (click)="onSortBy('totalStock')" [ngClass]="{'selected': sortBy === 'totalStock'}">
            <p>STOCK</p>
            <mat-icon>{{ sortBy === 'totalStock' ? 'filter_list' : 'filter_list_off' }}</mat-icon>
            <span class="tooltip-text">Stock à la fin de la période</span>
          </div>
          <div class="tooltip" (click)="onSortBy('etpMag')" [ngClass]="{'selected': sortBy === 'etpMag'}">
            <p>ETPT<br />MAG.</p>
            <mat-icon>{{ sortBy === 'etpMag' ? 'filter_list' : 'filter_list_off' }}</mat-icon>
            <span class="tooltip-text">Total des ETP Travaillés sur la période par les magistrats affectés à ce
              contentieux</span>
          </div>
          <div class="tooltip" (click)="onSortBy('etpFon')" [ngClass]="{'selected': sortBy === 'etpFon'}">
            <p>ETPT<br />FON.</p>
            <mat-icon>{{ sortBy === 'etpFon' ? 'filter_list' : 'filter_list_off' }}</mat-icon>
            <span class="tooltip-text">Total des ETP Travaillés sur la période par les fonctionnaires affectés à ce
              contentieux</span>
          </div>
          <div class="tooltip" (click)="onSortBy('etpCont')" [ngClass]="{'selected': sortBy === 'etpCont'}">
            <p>ETPT<br />CONT.</p>
            <mat-icon>{{ sortBy === 'etpCont' ? 'filter_list' : 'filter_list_off' }}</mat-icon>
            <span class="tooltip-text">Total des ETP Travaillés sur la période par les contractuels affectés à ce
              contentieux</span>
          </div>
        </div>
        <div class="item">
          <div class="tooltip" (click)="onSortBy('realCoverage')" [ngClass]="{'selected': sortBy === 'realCoverage'}">
            <p>TAUX DE<br />COUVERTURE</p>
            <mat-icon>{{ sortBy === 'realCoverage' ? 'filter_list' : 'filter_list_off' }}</mat-icon>
            <span class="tooltip-text">Entrées / Sorties réelles de la période, en %</span>
          </div>
          <div class="tooltip" (click)="onSortBy('realDTESInMonths')"
            [ngClass]="{'selected': sortBy === 'realDTESInMonths'}">
            <p>DTES<br />INSTANTANÉ</p>
            <mat-icon>{{ sortBy === 'realDTESInMonths' ? 'filter_list' : 'filter_list_off' }}</mat-icon>
            <span class="tooltip-text">Test</span>
          </div>
          <div class="tooltip" (click)="onSortBy('realTimePerCase')"
            [ngClass]="{'selected': sortBy === 'realTimePerCase'}">
            <p>TPS MOYEN<br />/ DOSSIER OBSERVÉ</p>
            <mat-icon>{{ sortBy === 'realTimePerCase' ? 'filter_list' : 'filter_list_off' }}</mat-icon>
            <span class="tooltip-text">Test</span>
          </div>
        </div>
        <div class="item">
          <div class="tooltip" (click)="onSortBy('calculateCoverage')"
            [ngClass]="{'selected': sortBy === 'calculateCoverage'}">
            <p>TAUX DE<br />COUVERTURE</p>
            <mat-icon>{{ sortBy === 'calculateCoverage' ? 'filter_list' : 'filter_list_off' }}</mat-icon>
            <span class="tooltip-text">C'est le rapport entre les sorties et les entrées</span>
          </div>
          <div class="tooltip" (click)="onSortBy('calculateDTESInMonths')"
            [ngClass]="{'selected': sortBy === 'calculateDTESInMonths'}">
            <p>DTES<br />CALCULÉ</p>
            <mat-icon>{{ sortBy === 'calculateDTESInMonths' ? 'filter_list' : 'filter_list_off' }}</mat-icon>
            <span class="tooltip-text">Test</span>
          </div>
          <div class="tooltip" (click)="onSortBy('calculateTimePerCase')"
            [ngClass]="{'selected': sortBy === 'calculateTimePerCase'}">
            <p>TEMPS MOYEN<br />/ DOSSIER SAISI</p>
            <mat-icon>{{ sortBy === 'calculateTimePerCase' ? 'filter_list' : 'filter_list_off' }}</mat-icon>
            <span class="tooltip-text">Temps saisi dans la page des <a routerLink="/temps-moyens">Temps
                moyens</a></span>
          </div>
          <div class="tooltip last" (click)="onSortBy('calculateOut')"
            [ngClass]="{'selected': sortBy === 'calculateOut'}">
            <p>SORTIES<br />POSSIBLES</p>
            <mat-icon>{{ sortBy === 'calculateOut' ? 'filter_list' : 'filter_list_off' }}</mat-icon>
            <span class="tooltip-text">Ce sont le sortie théoriques calculé au temps de dossier saisi</span>
          </div>
        </div>
      </div>
    </div>
    <div class="content-list">
      <aj-referentiel-calculator *ngFor="let r of datasFilted; trackBy: trackBy" [calculator]="r" [sortBy]="sortBy">
      </aj-referentiel-calculator>
    </div>
  </div>
</aj-wrapper>

<ng-template #actions>
  <aj-select title="Contentieux" [value]="referentielIds" [datas]="formReferentiel"
    (valueChange)="updateReferentielSelected('referentiel', $event)">
  </aj-select>
  <div class="flex-1"></div>
  <aj-date-select title="Pour la période du" [value]="dateStart"
    (valueChange)="updateReferentielSelected('dateStart', $event)" class="date-start">
  </aj-date-select>
  <aj-date-select title="À" [value]="dateStop" (valueChange)="updateReferentielSelected('dateStop', $event)"
    class="date-stop">
  </aj-date-select>
  <aj-options-backup-panel [readOnly]="true"></aj-options-backup-panel>
</ng-template>